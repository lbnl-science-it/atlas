

r for atlas eta project - dev notes
===================================


FROM ghcr.io/lbnl-science-it/atlas:base     # r-base official image
FROM tin6150/atlas:base                     # same as above, but build manually and pushed to dockerhub, so it works in aws/ubuntu
FROM ghcr.io/lbnl-science-it/atlas:altbase  # Debian or other OS, then install R as package.  last test with debian:testing, tidyverse was not fully installed.


        #@@ docker build -t lbnl-science-it/atlas -f Dockerfile .  | tee Dockerfile.monolithic.LOG
        #@@ docker tag lbnl-science-it/atlas tin6150/atlas
        docker build -t tin6150/atlas -f Dockerfile .  | tee Dockerfile.monolithic.LOG
        docker push     tin6150/atlas                     # worked :)
        docker run  -it --entrypoint=bash   tin6150/atlas

        # docker run  -it --entrypoint=bash   lbnl-science-it/atlas  # not sure if docker hub exist for lbnl-science-it


        docker build -t tin6150/atlas:base -f Dockerfile.base .  | tee Dockerfile.base.LOG
        docker push tin6150/atlas:base 
        # trying out base, split into multiple Dockerfile later...
        # ghcr docker-publish.yml workflow only work with "Dockerfile", 
        # so will have a branch-specific sym link for this file

        docker run -it tin6150/atlas:base ## hmm, R doesn't work here either

        docker run -it ghcr.io/lbnl-science-it/atlas:base ## R still won't run in Mint, but works on centos7
        docker run -it --entrypoint=bash ghcr.io/lbnl-science-it/atlas:base 
        # also tested build with ubuntu-18.04 in r4eta, R still won't run in Mint.


build via layers
----------------

	# perform build on CentOS machine, so that R is usable in aws/ubuntu instance.
        docker build -t tin6150/atlas:base -f Dockerfile.base  .  | tee LOG.Dockerfile.base.2022.0203
        # for now, still in base branch running this manually ex4
        docker build -t tin6150/atlas:l2   -f Dockerfile.atlas .  | tee LOG.Dockerfile.atlas.2022.0203
        docker push     tin6150/atlas:l2
        docker run -it --entrypoint=bash tin6150/atlas:l2


        branch 
          - base: back to using r-base image, will have to do manual build on CentOS and push to docker hub for use on aws/ubuntu
          - altbase: resume work on finding alternate (non ubuntu) os base that has R 4.1 and can get apollo package in it.  no good solution at this point.






	
(see tin6150/r4eta for additional build commands)

